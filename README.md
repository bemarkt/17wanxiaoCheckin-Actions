# ğŸ¹17wanxiaoCheckin-Actions



> åŸºäºGitHub-Actionsçš„å®Œç¾æ ¡å›­å¥åº·æ‰“å¡
>
> æ¯å¤©æ—©ä¸Šå…­ç‚¹è‡ªåŠ¨æ‰“å¡ï¼Œå¾®ä¿¡æ¨é€æ‰“å¡ä¿¡æ¯
>
> å›¾åºŠä½¿ç”¨ï¼šSM.MS -- https://sm.ms/ -- å›¾ç‰‡è¿‡å¤šå¯èƒ½åŠ è½½ç¼“æ…¢ï¼Œè€å¿ƒç­‰å¾…~
>
> æ¬¢è¿forkä½¿ç”¨âœ¨ï¼Œä¸€èµ·äº¤æµå­¦ä¹ 



## ä½ å¯ä»¥åœ¨æ­¤é¡¹ç›®ä¸­å­¦åˆ°çš„ä¸œè¥¿

1ã€æ¨¡æ‹Ÿå™¨ä½¿ç”¨httpcanaryæŠ“åŒ…ï¼ˆå…¶å®è¿˜å¯ä»¥ä½¿ç”¨fiddleè¿›è¡ŒæŠ“åŒ…ï¼‰

2ã€httpcanaryçš„åˆæ­¥ä½¿ç”¨

3ã€GitHub Actionsè‡ªåŠ¨åŒ–éƒ¨ç½²Pythonè„šæœ¬

4ã€......

## å¤æ‚çš„é£Ÿç”¨æ–¹æ³•

### ä¸€ã€æ¨¡æ‹Ÿå™¨æŠ“åŒ…è·å–æ•°æ®ï¼ˆå¦‚æœä½ çš„æ‰‹æœºå·²ROOTå¯ä»¥ç›´æ¥ç”¨æ‰‹æœºå“¦ï¼‰

#### 1ã€æ¨¡æ‹Ÿå™¨é…ç½®åŠä½¿ç”¨

- å¤©ç¿¼ç½‘ç›˜ï¼ˆå«é›·ç¥æ¨¡æ‹Ÿå™¨ã€å®Œç¾æ ¡å›­ã€httpcanaryå®‰è£…åŒ…ï¼‰
- ç‚¹é“¾æ¥è¿›å»å…¨éƒ¨ä¸‹ä¸‹æ¥ï¼šhttps://cloud.189.cn/t/VRZryeb2aIBr
- è§£å‹é›·ç¥æ¨¡æ‹Ÿå™¨å‹ç¼©åŒ…å¹¶ç‚¹å‡»ç»¿åŒ–ï¼ˆå‡ºç°ä»€ä¹ˆå¼‚å¸¸çš„è¯æŠŠæ€æ¯’è½¯ä»¶å…³é—­ï¼‰
- ç»¿åŒ–å®Œæˆç‚¹å‡»æ¡Œé¢å›¾æ ‡å¯åŠ¨
- æ‹–åŠ¨apkæ–‡ä»¶åˆ°æ¨¡æ‹Ÿå™¨çª—å£å®Œæˆappçš„å®‰è£…

![](https://i.loli.net/2020/07/18/Q5ikyFsXA1gpOz6.png)

![](https://i.loli.net/2020/07/18/GSpQnEM7Jfx8OaK.png)

![](https://i.loli.net/2020/07/18/Y7xnzh24se8f6WX.png)

#### 2ã€httpcanaryçš„é…ç½®åŠä½¿ç”¨

- æ‰“å¼€åˆšåˆšå®‰è£…åœ¨æ¡Œé¢çš„Httpcanary
- å®‰è£…è¯ä¹¦å¹¶ç§»åŠ¨åˆ°æ ¹ç›®å½•
- è®¾ç½®ç›®æ ‡åº”ç”¨ä¸ºå®Œç¾æ ¡å›­APPï¼ˆå°±ä¸éœ€è¦å…¶ä½™æ“ä½œäº†ï¼Œä¸è¦ç‚¹å³ä¸‹è§’çš„å°é£æœºï¼‰

![](https://i.loli.net/2020/07/18/VYSIl7DLqkb3w1x.png)

![](https://i.loli.net/2020/07/18/CsNoFP2nBJQH6Df.png)

![](https://i.loli.net/2020/07/18/1NUEcpAITgt9eMm.png)

#### 3ã€å¼€å§‹æŠ“åŒ…

- æ‰“å¼€å®Œç¾æ ¡å›­appï¼ˆæ˜¾ç¤ºrootå¿½ç•¥å³å¯ï¼‰ï¼Œè¿›å…¥å¥åº·æ‰“å¡å¹¶è®¾ç½®ç›¸å…³ä¿¡æ¯ï¼ˆä¸æäº¤ï¼‰
- åˆ‡æ¢åˆ°httpcanaryï¼Œå¼€å¯æŠ“åŒ…ï¼ˆç‚¹å³ä¸‹è§’çš„å°é£æœºï¼‰
- åˆ‡æ¢å®Œç¾æ ¡å›­æäº¤ä¿¡æ¯ï¼Œæ‰“å¡æˆåŠŸ
- åˆ‡æ¢httpcanaryï¼Œåœæ­¢æŠ“åŒ…

![](https://i.loli.net/2020/07/18/Lw5SOp1R9oeV4YQ.png)

#### 4ã€æŠ“åŒ…åˆ†æ

- ç¿»é˜…æ‰¾åˆ°sasså­—æ ·çš„é“¾æ¥ï¼Œç‚¹å‡»è¿›å»ï¼ˆå¦‚æœæœ‰å¤šä¸ª, è¯·ç‚¹é ä¸Šé¢çš„ï¼‰
- ç¬¬ä¸€ä¸ªæ¡†ä¸ºè¯·æ±‚è¿æ¥ï¼Œç¬¬äºŒä¸ªæ¡†ä¸ºæ­¤ç½‘ç»œè¯·æ±‚ä¸ºpostè¯·æ±‚
- ç‚¹å‡»è¯·æ±‚ä¸€æ ï¼Œå¹¶åœ¨åº•éƒ¨é€‰æ‹©textï¼Œå³å¯æŸ¥çœ‹è‡ªå·±æ‰€å¡«å†™çš„æ•°æ®ï¼ˆè®°ä¸‹æ¥ï¼Œæˆ–è€…å¤åˆ¶å‡ºå»ï¼‰
- ç‚¹å‡»å“åº”ä¸€æ ï¼Œå¹¶åœ¨åº•éƒ¨é€‰æ‹©textï¼Œå³å¯æŸ¥çœ‹å“åº”ç»“æœï¼ˆæˆåŠŸåˆ™ä¸ºæ‰“å¡æˆåŠŸï¼Œæ‰“å¡é¢‘ç¹åˆ™å¤±è´¥ï¼‰
- è‡³æ­¤æˆ‘ä»¬å°±è·å¾—äº†æˆ‘ä»¬ç»å¤§å¤šæ•°çš„æ•°æ®äº†ï¼ˆä¸‹é¢é¡¹ç›®ä½¿ç”¨çš„æ•°æ®å¡«å†™éœ€è¦ï¼‰

![](https://i.loli.net/2020/07/18/EczZY21WAQdgs5N.png)



### äºŒã€Serveré…±æœåŠ¡çš„ç”³è¯·

#### 1ã€ç”³è¯·ä¸€ä¸ªGItHubè´¦å·

- Githubå®˜ç½‘ï¼šhttps://github.com/ ï¼ˆä½¿ç”¨é‚®ç®±æ³¨å†Œå¹¶éªŒè¯ï¼‰

#### 2ã€æ³¨å†ŒServeré…±æœåŠ¡ï¼Œå¹¶ç»‘å®šå¾®ä¿¡

- Serveré…±å®˜ç½‘ï¼šhttp://sc.ftqq.com/3.version 
- ä½¿ç”¨åˆšæ³¨å†Œçš„Githubè´¦å·ç™»å½•
- å¾®ä¿¡ç»‘å®šï¼Œæ‰«ç å…³æ³¨å³å¯ç»‘å®š
- æµ‹è¯•ä¸€ä¸‹æ˜¯å¦èƒ½æ¨é€æˆåŠŸï¼Œå¹¶å¤åˆ¶ä¸‹è‡ªå·±çš„SCKEYï¼ˆä¸‹é¢é¡¹ç›®ä½¿ç”¨çš„æ•°æ®å¡«å†™éœ€è¦ï¼‰
- è‡³æ­¤æˆ‘ä»¬å°±è·å¾—äº†æˆ‘ä»¬çš„æœ€åä¸€ä¸ªæ•°æ®ï¼Œæ¥ä¸‹æ¥å°±æ˜¯äº†è§£å¦‚ä½•ä½¿ç”¨æ­¤é¡¹ç›®æ–‡ä»¶äº†

![](https://i.loli.net/2020/07/18/LReTUqoZNirdX12.png)

![](https://i.loli.net/2020/07/18/wvR9UjQum4OeyJM.png)

![](https://i.loli.net/2020/07/18/Pjkzg1i6hdIbWnH.png)

![](https://i.loli.net/2020/07/18/hj8q7flIvW4mwbE.png)

![](https://i.loli.net/2020/07/18/kuMFjAKB45fWS6s.png)

### ä¸‰ã€é¡¹ç›®forkä¸éƒ¨ç½²

#### 1ã€ç‚¹å‡»é“¾æ¥è¿›å…¥é¡¹ç›®æ–‡ä»¶å¹¶forkåˆ°è‡ªå·±çš„GitHubä¸Š

- æ­¤é¡¹ç›®åœ°å€ï¼šhttps://github.com/ReaJason/17wanxiaoCheckin-Actions

- ç‚¹å‡»å³ä¸Šè§’çš„forkå³å¯å°†é¡¹ç›®æ–‡ä»¶æ‹‰åˆ°è‡ªå·±çš„åº“ä¸­

![](https://i.loli.net/2020/07/18/FCA6SNqcLyBg8Qe.png)

![](https://i.loli.net/2020/07/18/COrWqn8BcXZP6GT.png)

#### 2ã€è®¾ç½®Secretsï¼Œè¾“å…¥é¡¹ç›®è¿è¡Œçš„æ•°æ®

- æ‰¾åˆ°è‡ªå·±forkçš„åº“ï¼Œç‚¹å‡»Settings->Secrets->New sceret

- å­—æ®µåä½¿ç”¨å¤§å†™ï¼Œå»ºè®®ç›´æ¥å¤åˆ¶æ·»åŠ ï¼Œå­—æ®µå€¼åˆ™å¡«å†™è‡ªå·±è·å–çš„å€¼ã€‚

| å­—æ®µå (å«ä¹‰)                   | å­—æ®µå€¼                                                       |
| ------------------------------- | ------------------------------------------------------------ |
| SCKEY (Serveré…±å¾®ä¿¡æ¨é€)        | SCU********                                                  |
| RAW_JSON (æŠ“åŒ…ä¸­çš„åŸå§‹JSONå†…å®¹) | {"businessType":"epmpics","method":"submitUpInfo","jsonData":{"deptStr":{"deptid":.... ,"gpsType":0}} |

![](https://i.loli.net/2020/07/18/vSkAs1hP6NU2Dce.png)

![](https://i.loli.net/2020/07/18/l6PTUNbJIMDGA4O.png)

![](https://i.loli.net/2020/07/18/5tNdbimDaqIUgYZ.png)

#### 3ã€å¼€å¯Actions

- æ‰¾åˆ°è‡ªå·±forkçš„åº“ï¼Œç‚¹å‡»Settings->Action->I understand...

- å›åˆ°é¡¹ç›®ä¸»é¡µï¼Œä¿®æ”¹README.mdè§¦å‘Actions

![](https://i.loli.net/2020/07/18/HjxTdCnhuAgLqXy.png)

![](https://i.loli.net/2020/07/18/ZbcJ7LlhDgqtaId.png)

![](https://i.loli.net/2020/07/18/v9WufB8Znhk3wSt.png)

![](https://i.loli.net/2020/07/18/p7nj4ZAbId9cRSh.png)

![](https://i.loli.net/2020/07/18/l87JNvr9fHceugU.png)

#### 4ã€æŸ¥çœ‹ç»“æœ

- é€šè¿‡Update README.md -- > build -- > HealthCheckin
- æ‰‹æœºå¾®ä¿¡æ¨é€æŸ¥çœ‹
- æˆåŠŸäº†ä¸€æ¬¡ä¹‹ååˆ™å¼€å¯äº†è‡ªåŠ¨åŒ–éƒ¨ç½²ï¼ˆæ¯å¤©æ—©ä¸Šå…­ç‚¹è‡ªåŠ¨æ‰“å¡ï¼‰
- å¦‚æœå¤±è´¥ï¼Œåˆ™åœ¨è¿è¡ŒçŠ¶å†µçš„HealthCheckinä¸­æŸ¥çœ‹æŠ¥é”™æƒ…å†µï¼Œè§£å†³ä¸äº†å¯ä»¥æissue

![](https://i.loli.net/2020/07/18/OVmruRa6dIpqZfA.png)

<img src="https://i.loli.net/2020/07/18/xGCrN6tdFBSiZgh.jpg" style="zoom:25%;" />

### å››ã€Actionså…·ä½“æµç¨‹

> Tipsï¼šactionsé…ç½®æ–‡ä»¶åœ¨\.github\workflows\run.ymlä¸­
>

#### 1ã€è®¡åˆ’æ—¶é—´å‚æ•°

```python
schedule:
   - cron: 0 22 * * * # è¡¨ç¤ºæ¯å¤©6ç‚¹è¿›è¡Œä»»åŠ¡
# cronåé¢çš„æ—¶é—´ä¸ºå›½é™…äº‹ä»¶
# äº”ä½æ•°(ç©ºæ ¼åˆ†éš”)åˆ†åˆ«ä¸ºåˆ†é’Ÿã€å°æ—¶ã€å¤©ã€æœˆã€ä¸€ä¸ªæ˜ŸæœŸçš„ç¬¬å‡ å¤©
# å›½é™…æ—¶ä¸åŒ—äº¬æ—¶çš„æŸ¥è¯¢ç½‘ç«™ï¼šhttp://www.timebie.com/cn/universalbeijing.php
```

#### 2ã€Install Python

```python
# ä¸ºè™šæ‹Ÿæœºå®‰è£…python3ç¯å¢ƒ
run: |
    sudo apt update && \
    sudo apt install python3
# ç”±äºä½¿ç”¨çš„æ˜¯Ubuntuçš„è™šæ‹Ÿæœºï¼Œå› æ­¤æ‰§è¡Œçš„æ˜¯linuxè¯­å¥
```

#### 3ã€Pip install requests

```python
# ä¸ºpyç¨‹åºçš„æ‰§è¡Œå®‰è£…ç¬¬ä¸‰æ–¹åº“requests
run: |
    pip3 install requests -i https://pypi.tuna.tsinghua.edu.cn/simple
```

#### 4ã€HealthCheckin

```python
# è¿è¡Œpyè„šæœ¬æ–‡ä»¶
run: |
    python3 17wanxiao.py <<EOF
    ${{secrets.SCKEY}}
    ${{secrets.RAW_JSON}}
    EOF
```

> æ„Ÿè°¢ä½ çš„ä½¿ç”¨ï¼Œè§‰å¾—å¯ä»¥çš„è¯ï¼Œå¯ä¸å¯ä»¥ç»™ä¸ªå…è´¹çš„starâœ¨
